<!doctype html>
<html>
	<head>
		<title>Primary Server - Location</title>
		<link rel="stylesheet" type="text/css" href="/css/style.css" />
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

		<script type="text/javascript" src="/js/tools.js"></script>
		<script type="text/javascript" src="/js/control.js"></script>

		<script type="text/javascript" src="jsmpeg.min.js"></script>
		<script type="text/javascript">
			function genericFunction(url, cFunction, elem) {
				var streamno = elem.parentNode.id;
				url += streamno;
				console.log(url);
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function () {
					if (this.readyState == 4 && this.status == 200) {
						cFunction(this, streamno);
					}
				};
				xhttp.open('GET', url, true);
				xhttp.send();
			}

			function loadText(xhttp, streamno) {
				document.getElementById('demo').innerHTML = xhttp.responseText;
			}

			function jsmpegPlay(xhttp, streamno) {
				var stream1 = document.getElementById(streamno);
				console.log(stream1.parentElement);
				stream1.parentElement.insertBefore(canvas1, stream1);
				if (player1 == 'initial state') {
					player1 = new JSMpeg.Player(url1, {
						canvas: canvas1,
						autoplay: false,
						pauseWhenHidden: false,
						videoBufferSize: 100 * 1024,
						audioBufferSize: 50 * 1024,
					});
				}
				player1.play();
				player1.volume = 1;
				return false;
			}

			function jsmpegStop() {
				player1.stop();
				return false;
			}

			function jsmpegVolumeup() {
				player1.volume = player1.volume + 0.2;
				return false;
			}

			function jsmpegVolumedown() {
				player1.volume = player1.volume - 0.2;
				if (player1.volume < 0) {
					player1.volume = 0;
				}
				return false;
			}
		</script>
	</head>
	<body>
		<div class="response-box" id="responseBox">
			<!-- AJAX responses will appear here -->
		</div>

		<section class="hero-section">
			<nav>
				<ul>
					<li><a href="/control.html">Control</a></li>
					<li><a href="/settings.html">Settings</a></li>
					<li><a href="/stat">Stats</a></li>
					<li><a href="/recording">Recordings</a></li>
					<li><a href="/config.php?proclist">Processes</a></li>
				</ul>
			</nav>
			<h1 id="server-name">Primary/Secondary Server - Location</h1>
			<p id="serverdetails">Test</p>
			<script>
				var address = window.location.hostname;
				var rtmp = 'Send primary stream to rtmp://';
				fulladdress = rtmp.concat(address, '/main/stream1 or stream2 or stream 3 etc.');
				rtmp = 'Send backup stream to rtmp://';
				backupaddress = rtmp.concat(address, '/backup/stream1 or stream2 or stream 3 etc.');
				document.getElementById('serverdetails').innerHTML = fulladdress + '<br/>' + backupaddress;
			</script>
		</section>

		<div style="text-align: center" class="padded"></div>

		<div style="text-align: center" class="padded">
			<form method="post" target="_blank" action="/config.php?remap">
				<p>
					<b>No. of Audio Channels: </b><input type="text" name="channel_no" size="5" placeholder="4" /><select name="outputdest">
						<option value="main">Main</option>
						<option value="backup">Backup</option>
					</select>
					&nbsp;
					<input type="submit" value="Remap On" />
				</p>
			</form>
			<form method="post" target="_blank" action="/config.php?remapoff">
				<p>
					<b>Turn off Remapping: </b>
					<select name="outputdest">
						<option value="main">Main</option>
						<option value="backup">Backup</option>
					</select>
					&nbsp;
					<input type="submit" value="Remap Off" />
				</p>
			</form>
		</div>

		<div style="text-align: center" class="padded">
			<p>SRT Accept: <a href="/config.php?srtaccept" target="_blank"> ON</a> ||| <a href="/config.php?srtacceptoff" target="_blank"> OFF</a></p>
		</div>

		<div class="padded">
			<p>
				<b>Supers - Global Control:</b> <a href="/control.php?allsuper1on" target="_blank">Add 1</a> |||
				<a href="/control.php?allsuper2on" target="_blank">Add 2</a> ||| <a href="/control.php?allsuper3on" target="_blank">Add 3</a> |||
				<a href="/control.php?allsuper4on" target="_blank">Add 4</a> ||| <a href="/control.php?allsuper5on" target="_blank">Add 5</a> |||
				<a href="/control.php?allsuper6on" target="_blank">Add 6</a> ||| <a href="/control.php?allsuper7on" target="_blank">Add 7</a> |||
				<a href="/control.php?allsuper8on" target="_blank">Add 8</a> ||| <a href="/control.php?allsuperoff" target="_blank">Remove</a>
			</p>
		</div>

		<section id="stream-controls"></section>

		<div class="divider">
			<img src="./img/red-divider.svg" alt="divider" />
		</div>
	</body>
</html>
